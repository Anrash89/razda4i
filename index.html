<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–î–µ–ª–æ –≤ –®–ª—è–ø–µ | Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7;
            --primary-dark: #5649c0;
            --bg: #f0f2f5;
            --surface: #ffffff;
            --text-main: #2d3436;
            --text-sec: #636e72;
            --success: #00b894;
            --warning: #fdcb6e;
            --danger: #ff7675;
            --radius: 20px;
            --shadow: 0 10px 30px rgba(0,0,0,0.06);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #dfe6e9;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }

        .app {
            width: 100%;
            max-width: 420px;
            height: 100%;
            background: var(--bg);
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.15);
        }

        @media (min-width: 425px) { .app { height: 95vh; border-radius: 30px; margin-top: 2.5vh; } }

        /* --- Header --- */
        .header {
            padding: 15px 20px;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 100;
            height: 60px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .header h1 { font-size: 17px; margin: 0; font-weight: 700; color: var(--text-main); }
        .back-btn {
            border: none; background: #f1f2f6; width: 32px; height: 32px;
            border-radius: 50%; color: var(--text-main); cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: 0.2s;
        }
        .back-btn.visible { opacity: 1; pointer-events: auto; }

        /* --- Content --- */
        .content { flex: 1; overflow-y: auto; padding: 20px; position: relative; padding-bottom: 40px; }

        .screen { display: none; animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        .screen.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Components --- */
        .btn {
            width: 100%; padding: 16px; border-radius: 14px; border: none;
            font-weight: 600; font-size: 15px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            transition: 0.1s; position: relative; overflow: hidden;
        }
        .btn:active { transform: scale(0.98); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        
        .btn-primary { background: var(--primary); color: white; box-shadow: 0 4px 15px rgba(108, 92, 231, 0.3); }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: white; color: var(--danger); border: 1px solid var(--danger); }
        .btn-outline { background: transparent; border: 1px solid #dcdde1; color: var(--text-sec); }

        .card {
            background: var(--surface); border-radius: var(--radius); padding: 20px;
            margin-bottom: 15px; box-shadow: var(--shadow);
        }

        /* --- Role Select --- */
        .role-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .role-card {
            background: white; padding: 30px 15px; border-radius: 20px; text-align: center;
            cursor: pointer; transition: 0.2s; border: 2px solid transparent; box-shadow: var(--shadow);
        }
        .role-card:active { transform: scale(0.95); }
        .role-emoji { font-size: 36px; display: block; margin-bottom: 10px; }

        /* --- Buyer Styles --- */
        .product-card {
            background: white; border-radius: 20px; overflow: hidden; margin-bottom: 20px;
            box-shadow: var(--shadow); position: relative; cursor: pointer;
        }
        .prod-img { width: 100%; height: 180px; object-fit: cover; background: #eee; }
        .prod-info { padding: 15px; }
        .cashback-badge {
            position: absolute; top: 15px; right: 15px; background: var(--success); color: white;
            padding: 5px 10px; border-radius: 8px; font-weight: 700; font-size: 12px;
            box-shadow: 0 4px 10px rgba(0, 184, 148, 0.3);
        }

        .stepper { display: flex; justify-content: space-between; margin-bottom: 25px; position: relative; }
        .stepper::before {
            content: ''; position: absolute; top: 10px; left: 0; right: 0; height: 3px;
            background: #e0e0e0; z-index: 0;
        }
        .step {
            width: 24px; height: 24px; border-radius: 50%; background: #e0e0e0;
            position: relative; z-index: 1; border: 3px solid var(--bg);
            transition: 0.3s;
        }
        .step.active { background: var(--primary); transform: scale(1.2); }
        .step.done { background: var(--success); }

        .upload-zone {
            border: 2px dashed #b2bec3; border-radius: 16px; padding: 30px;
            text-align: center; color: #999; cursor: pointer; transition: 0.2s;
            background: #fdfdfd; margin: 15px 0;
        }
        .upload-zone.done { border-color: var(--success); background: #e6fffa; color: var(--success); }

        /* --- SELLER CRM STYLES (Rich Cards) --- */
        .tabs { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px; margin-bottom: 15px; scrollbar-width: none; }
        .tabs::-webkit-scrollbar { display: none; }
        .tab {
            padding: 8px 16px; background: white; border-radius: 20px; font-size: 13px;
            font-weight: 600; color: var(--text-sec); white-space: nowrap; cursor: pointer;
        }
        .tab.active { background: var(--primary); color: white; }

        .crm-card {
            background: white; border-radius: 16px; padding: 15px; margin-bottom: 15px;
            box-shadow: var(--shadow); cursor: pointer; transition: transform 0.1s;
        }
        .crm-card:active { transform: scale(0.98); }
        
        .crm-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .user-row { display: flex; align-items: center; gap: 10px; }
        .avatar { width: 32px; height: 32px; border-radius: 50%; object-fit: cover; }
        .crm-time { font-size: 11px; color: #999; background: #f5f5f5; padding: 4px 8px; border-radius: 6px; }
        
        .crm-body { display: flex; gap: 12px; background: #f8f9fa; padding: 10px; border-radius: 12px; }
        .crm-thumb { width: 50px; height: 50px; border-radius: 8px; object-fit: cover; }
        
        .crm-footer { margin-top: 12px; display: flex; align-items: center; justify-content: space-between; }
        .status-badge { font-size: 12px; font-weight: 600; padding: 4px 10px; border-radius: 6px; }
        .sb-blue { background: #eef1ff; color: var(--primary); }
        .sb-orange { background: #fff5e6; color: #e17055; }
        .sb-green { background: #e6fffa; color: var(--success); }

        /* --- Overlays --- */
        .loader-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255,255,255,0.9); z-index: 200;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: 0.3s;
        }
        .loader-overlay.show { opacity: 1; pointer-events: auto; }
        .spinner {
            width: 40px; height: 40px; border: 4px solid #eee; border-top-color: var(--primary);
            border-radius: 50%; animation: spin 0.8s linear infinite; margin-bottom: 15px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        .toast {
            position: absolute; bottom: 30px; left: 20px; right: 20px;
            background: #2d3436; color: white; padding: 16px; border-radius: 12px;
            display: flex; align-items: center; gap: 10px; font-size: 14px; font-weight: 500;
            transform: translateY(100px); transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 300;
        }
        .toast.show { transform: translateY(0); }

    </style>
</head>
<body>

<div class="app">
    <div class="header">
        <button class="back-btn" id="backBtn" onclick="goBack()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
        </button>
        <h1 id="page-title">–î–µ–ª–æ –≤ –®–ª—è–ø–µ</h1>
        <div style="width: 32px;"></div>
    </div>

    <div class="content">

        <div id="screen-home" class="screen active">
            <div style="text-align: center; margin-top: 40px; margin-bottom: 40px;">
                <div style="font-size: 50px; margin-bottom: 10px;">üé©</div>
                <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</h2>
                <p style="color: var(--text-sec); font-size: 14px;">–ï–¥–∏–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–µ–ª–ª–µ—Ä–æ–≤ –∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</p>
            </div>

            <div class="role-grid">
                <div class="role-card" onclick="setRole('buyer')">
                    <span class="role-emoji">üõç</span>
                    <b>–Ø –ü–æ–∫—É–ø–∞—Ç–µ–ª—å</b>
                    <div style="font-size: 11px; color: #aaa; margin-top: 5px;">–•–æ—á—É 100% –ö—ç—à–±—ç–∫</div>
                </div>
                <div class="role-card" onclick="setRole('seller')">
                    <span class="role-emoji">üíº</span>
                    <b>–Ø –°–µ–ª–ª–µ—Ä</b>
                    <div style="font-size: 11px; color: #aaa; margin-top: 5px;">CRM –∏ –í—ã–ø–ª–∞—Ç—ã</div>
                </div>
            </div>
            
            <div style="margin-top: 30px; background: white; padding: 15px; border-radius: 16px; box-shadow: var(--shadow);">
                <div style="font-weight: 600; font-size: 13px; margin-bottom: 5px;">üì¢ –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞</div>
                <div style="font-size: 12px; color: var(--text-sec);">–î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ-–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –≤—ã–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ –°–ë–ü.</div>
            </div>
        </div>

        <div id="screen-catalog" class="screen">
            <h2 style="margin-bottom: 20px;">–ö–∞—Ç–∞–ª–æ–≥</h2>
            
            <div class="product-card" onclick="startTask('Roman Magic', 'https://ir.ozone.ru/s3/multimedia-0/wc1000/6647987820.jpg')">
                <div class="cashback-badge">100% –ö—ç—à–±—ç–∫</div>
                <img src="https://ir.ozone.ru/s3/multimedia-0/wc1000/6647987820.jpg" class="prod-img">
                <div class="prod-info">
                    <div style="font-weight: 700; font-size: 16px; margin-bottom: 5px;">–ù–∞–±–æ—Ä –æ–ø—ã—Ç–æ–≤ Roman Magic</div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #b2bec3; text-decoration: line-through; font-size: 13px;">1200 ‚ÇΩ</span>
                        <span style="color: var(--success); font-weight: 700;">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    </div>
                </div>
            </div>

            <div class="product-card" onclick="startTask('Chemistry Kids', 'https://ir.ozone.ru/s3/multimedia-v/wc1000/6682736467.jpg')">
                <div class="cashback-badge">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</div>
                <img src="https://ir.ozone.ru/s3/multimedia-v/wc1000/6682736467.jpg" class="prod-img">
                <div class="prod-info">
                    <div style="font-weight: 700; font-size: 16px; margin-bottom: 5px;">–Æ–Ω—ã–π –•–∏–º–∏–∫</div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #b2bec3; text-decoration: line-through; font-size: 13px;">950 ‚ÇΩ</span>
                        <span style="color: var(--success); font-weight: 700;">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="screen-task" class="screen">
            <div class="stepper">
                <div class="step active" id="s1"></div> <div class="step" id="s2"></div> <div class="step" id="s3"></div> <div class="step" id="s4"></div> <div class="step" id="s5"></div> </div>
            <div id="task-container"></div>
        </div>


        <div id="screen-crm" class="screen">
            <div style="background: var(--primary); padding: 25px; border-radius: 20px; color: white; margin-bottom: 20px; box-shadow: 0 10px 20px -5px rgba(108,92,231,0.4);">
                <div style="font-size: 13px; opacity: 0.8;">–ë–∞–ª–∞–Ω—Å</div>
                <div style="font-size: 28px; font-weight: 700; margin: 5px 0;">12 500 ‚ÇΩ</div>
                <div style="font-size: 12px; display: flex; gap: 15px;">
                    <span>–í —Ä–∞–±–æ—Ç–µ: <b>8</b></span>
                    <span>–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>142</b></span>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" onclick="filterCrm('all', this)">–í—Å–µ</div>
                <div class="tab" onclick="filterCrm('order', this)">–ó–∞–∫–∞–∑—ã (1)</div>
                <div class="tab" onclick="filterCrm('review', this)">–û—Ç–∑—ã–≤—ã (1)</div>
                <div class="tab" onclick="filterCrm('payout', this)">–í—ã–ø–ª–∞—Ç—ã (1)</div>
            </div>

            <div id="crm-list"></div>
        </div>

        <div id="screen-crm-detail" class="screen">
            <div id="crm-detail-content"></div>
        </div>

    </div>

    <div id="loader" class="loader-overlay">
        <div class="spinner"></div>
        <div style="font-weight: 600; color: var(--text-sec);">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...</div>
    </div>

    <div id="toast" class="toast">
        <span id="toast-icon">‚úÖ</span>
        <span id="toast-msg">–°–æ–æ–±—â–µ–Ω–∏–µ</span>
    </div>

</div>

<script>
    // --- STATE MANAGEMENT ---
    let historyStack = ['screen-home'];
    let currentTaskStep = 1;
    let currentTaskName = '';
    let currentTaskImg = '';
    
    // --- MOCK DATA (SELLER CRM) ---
    const crmData = [
        { 
            id: 101, 
            type: 'order', 
            user: '–û–ª—å–≥–∞ –ö.', 
            avatar: 'https://randomuser.me/api/portraits/women/44.jpg',
            prod: 'Roman Magic', 
            prodImg: 'https://ir.ozone.ru/s3/multimedia-0/wc1000/6647987820.jpg',
            time: '5 –º–∏–Ω', 
            status: '–°–∫—Ä–∏–Ω –∑–∞–∫–∞–∑–∞', 
            badge: 'sb-blue',
            proof: 'https://via.placeholder.com/300x500/333333/ffffff?text=SCREENSHOT+ORDER' 
        },
        { 
            id: 102, 
            type: 'review', 
            user: '–ú–∞–∫—Å–∏–º –ì.', 
            avatar: 'https://randomuser.me/api/portraits/men/32.jpg',
            prod: 'Roman Magic',
            prodImg: 'https://ir.ozone.ru/s3/multimedia-0/wc1000/6647987820.jpg', 
            time: '1 —á', 
            status: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∑—ã–≤–∞', 
            badge: 'sb-orange',
            text: '–û—Ç–ª–∏—á–Ω—ã–π –Ω–∞–±–æ—Ä! –†–µ–±–µ–Ω–∫—É –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å —Å–º–µ—à–∏–≤–∞—Ç—å —Ä–µ–∞–∫—Ç–∏–≤—ã. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–Ω—è—Ç–Ω–∞—è, –≤—Å—ë –±–µ–∑–æ–ø–∞—Å–Ω–æ.',
            photos: ['https://via.placeholder.com/100', 'https://via.placeholder.com/100']
        },
        { 
            id: 103, 
            type: 'payout', 
            user: '–ê–ª–∏–Ω–∞ –§.', 
            avatar: 'https://randomuser.me/api/portraits/women/12.jpg',
            prod: '–Æ–Ω—ã–π –•–∏–º–∏–∫', 
            prodImg: 'https://ir.ozone.ru/s3/multimedia-v/wc1000/6682736467.jpg',
            time: '2 —á', 
            status: '–ñ–¥–µ—Ç –≤—ã–ø–ª–∞—Ç—É', 
            badge: 'sb-green',
            amount: 950,
            bank: '–¢-–ë–∞–Ω–∫ ‚Ä¢ 89001234567'
        },
    ];

    // --- NAVIGATION LOGIC ---
    function goTo(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(screenId).classList.add('active');
        
        const backBtn = document.getElementById('backBtn');
        const title = document.getElementById('page-title');
        
        if (screenId === 'screen-home') {
            backBtn.classList.remove('visible');
            title.innerText = "–î–µ–ª–æ –≤ –®–ª—è–ø–µ";
            historyStack = ['screen-home'];
        } else {
            backBtn.classList.add('visible');
            historyStack.push(screenId);
        }

        if (screenId.includes('buyer')) title.innerText = "–ü–æ–∫—É–ø–∫–∞";
        if (screenId.includes('crm')) title.innerText = "–ö–∞–±–∏–Ω–µ—Ç –°–µ–ª–ª–µ—Ä–∞";
    }

    function goBack() {
        if (historyStack.length > 1) {
            historyStack.pop();
            const prev = historyStack[historyStack.length - 1];
            
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(prev).classList.add('active');
            
            if (prev === 'screen-home') {
                document.getElementById('backBtn').classList.remove('visible');
                document.getElementById('page-title').innerText = "–î–µ–ª–æ –≤ –®–ª—è–ø–µ";
            }
        }
    }

    function setRole(role) {
        if (role === 'buyer') goTo('screen-catalog');
        else {
            renderCrmList();
            goTo('screen-crm');
        }
    }

    // --- BUYER LOGIC (WIZARD) ---
    
    function startTask(name, img) {
        currentTaskName = name;
        currentTaskImg = img;
        currentTaskStep = 1;
        renderBuyerStep();
        goTo('screen-task');
    }

    function renderBuyerStep() {
        const container = document.getElementById('task-container');
        // Update Stepper Visuals
        [1,2,3,4,5].forEach(s => {
            const el = document.getElementById('s'+s);
            el.className = 'step';
            if (s < currentTaskStep) el.classList.add('done');
            if (s === currentTaskStep) el.classList.add('active');
        });

        let html = '';

        if (currentTaskStep === 1) { // SEARCH
            html = `
                <h2>üîé –®–∞–≥ 1: –ü–æ–∏—Å–∫</h2>
                <div class="card">
                    <p>1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Wildberries.</p>
                    <p>2. –í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å:</p>
                    <div style="background:#f1f2f6; padding:12px; border-radius:10px; font-weight:700; text-align:center; color:var(--primary); margin:10px 0;">–Ω–∞–±–æ—Ä –æ–ø—ã—Ç–æ–≤ –¥–ª—è –¥–µ—Ç–µ–π</div>
                    <p>3. –ù–∞–π–¥–∏—Ç–µ –±—Ä–µ–Ω–¥ <b>–î–µ–ª–æ –≤ –®–ª—è–ø–µ</b> –∏ —Ç–æ–≤–∞—Ä "${currentTaskName}".</p>
                    <img src="${currentTaskImg}" style="width:60px; height:60px; border-radius:8px; display:block; margin:10px auto;">
                </div>
                <button class="btn btn-primary" onclick="nextStep()">üì∏ –Ø –æ—Ñ–æ—Ä–º–∏–ª –∑–∞–∫–∞–∑</button>
            `;
        } 
        else if (currentTaskStep === 2) { // ORDER PROOF
            html = `
                <h2>üì∏ –®–∞–≥ 2: –°–∫—Ä–∏–Ω –∑–∞–∫–∞–∑–∞</h2>
                <p>–°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–î–æ—Å—Ç–∞–≤–∫–∏", –≥–¥–µ –≤–∏–¥–µ–Ω —Å—Ç–∞—Ç—É—Å "–û—Ñ–æ—Ä–º–ª–µ–Ω".</p>
                <div class="upload-zone" onclick="simulateUpload(this)">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç</div>
                <button id="btn-next" class="btn btn-primary" disabled onclick="simulateCheck()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É</button>
            `;
        }
        else if (currentTaskStep === 3) { // PICKUP
            html = `
                <div style="background:#e6fffa; color:var(--success); padding:10px; border-radius:10px; font-weight:600; margin-bottom:15px;">‚úÖ –ó–∞–∫–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω! –ñ–¥–µ–º –¥–æ—Å—Ç–∞–≤–∫—É.</div>
                <h2>üì¶ –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ</h2>
                <p>–ö–æ–≥–¥–∞ –∑–∞–±–µ—Ä–µ—Ç–µ —Ç–æ–≤–∞—Ä –∏–∑ –ü–í–ó, —Å–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ç–æ –∫–æ—Ä–æ–±–∫–∏.</p>
                <div class="upload-zone" onclick="simulateUpload(this)">üì∏ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ —Å –ü–í–ó</div>
                <button id="btn-next" class="btn btn-primary" disabled onclick="simulateCheck()">–Ø –∑–∞–±—Ä–∞–ª —Ç–æ–≤–∞—Ä</button>
            `;
        }
        else if (currentTaskStep === 4) { // REVIEW
            html = `
                 <h2>üìù –®–∞–≥ 4: –û—Ç–∑—ã–≤</h2>
                 <p>–ü—Ä–∏—à–ª–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ —Ñ–æ—Ç–æ –¥–ª—è –æ—Ç–∑—ã–≤–∞. –ú—ã –ø—Ä–æ–≤–µ—Ä–∏–º –µ–≥–æ –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π.</p>
                 <input type="text" placeholder="–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞..." style="width:100%; padding:15px; border-radius:12px; border:1px solid #ddd; margin-bottom:10px;">
                 <div class="upload-zone" onclick="simulateUpload(this)">üìÇ –§–æ—Ç–æ/–í–∏–¥–µ–æ –¥–ª—è –æ—Ç–∑—ã–≤–∞</div>
                 <button id="btn-next" class="btn btn-primary" disabled onclick="simulateCheck()">–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç</button>
            `;
        }
        else if (currentTaskStep === 5) { // PAYOUT
            html = `
                <h2>üí∞ –§–∏–Ω–∞–ª: –í—ã–ø–ª–∞—Ç–∞</h2>
                <p>–û—Ç–∑—ã–≤ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω! –í–≤–µ–¥–∏—Ç–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫—ç—à–±—ç–∫–∞.</p>
                <div class="upload-zone" onclick="simulateUpload(this)">‚≠ê –°–∫—Ä–∏–Ω –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–∑—ã–≤–∞</div>
                <input type="text" placeholder="+7 (900) ... (–°–ë–ü)" style="width:100%; padding:15px; border-radius:12px; border:1px solid #ddd; margin-bottom:15px;">
                <button id="btn-next" class="btn btn-success" disabled onclick="finishTask()">–ü–æ–ª—É—á–∏—Ç—å –¥–µ–Ω—å–≥–∏</button>
            `;
        }
        container.innerHTML = html;
    }

    // Buyer Simulation Utils
    function nextStep() { currentTaskStep++; renderBuyerStep(); }
    function simulateUpload(el) {
        el.innerText = "‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...";
        setTimeout(() => {
            el.innerHTML = "‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω";
            el.classList.add('done');
            document.getElementById('btn-next').disabled = false;
        }, 800);
    }
    function simulateCheck() {
        showLoader(true);
        setTimeout(() => { showLoader(false); showToast("‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä –æ–¥–æ–±—Ä–∏–ª –≤–∞—à –æ—Ç—á–µ—Ç!"); nextStep(); }, 1500);
    }
    function finishTask() {
        showLoader(true);
        setTimeout(() => { showLoader(false); alert("üéâ –í—ã–ø–ª–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ."); goTo('screen-home'); }, 2000);
    }


    // --- SELLER CRM LOGIC (RICH CARDS) ---

    function renderCrmList(filterType = 'all') {
        const container = document.getElementById('crm-list');
        container.innerHTML = '';
        
        crmData.forEach(item => {
            if (filterType !== 'all' && item.type !== filterType) return;
            
            // Rich Card HTML
            container.innerHTML += `
                <div class="crm-card" onclick="openCrmDetail(${item.id})">
                    <div class="crm-header">
                        <div class="user-row">
                            <img src="${item.avatar}" class="avatar">
                            <div style="font-weight:600; font-size:14px;">${item.user}</div>
                        </div>
                        <div class="crm-time">${item.time}</div>
                    </div>
                    <div class="crm-body">
                        <img src="${item.prodImg}" class="crm-thumb">
                        <div style="display:flex; flex-direction:column; justify-content:center;">
                            <div style="font-size:13px; font-weight:500;">${item.prod}</div>
                            <div style="font-size:11px; color:#999;">ID: #839${item.id}</div>
                        </div>
                    </div>
                    <div class="crm-footer">
                        <div class="status-badge ${item.badge}">${item.status}</div>
                        <div style="color:#ccc; font-size:12px;">‚ñ∂</div>
                    </div>
                </div>
            `;
        });
    }

    function filterCrm(type, tabEl) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        tabEl.classList.add('active');
        renderCrmList(type);
    }

    function openCrmDetail(id) {
        const item = crmData.find(i => i.id === id);
        const container = document.getElementById('crm-detail-content');
        
        let html = `
            <div style="display:flex; align-items:center; gap:10px; margin-bottom:20px;">
                <img src="${item.avatar}" style="width:40px; height:40px; border-radius:50%;">
                <div>
                    <h2 style="margin:0; font-size:18px;">${item.user}</h2>
                    <div style="color:#777; font-size:12px;">${item.prod}</div>
                </div>
            </div>
        `;

        // Dynamic Content based on Type
        if (item.type === 'order') {
            html += `
                <div class="card">
                    <div style="font-weight:600; margin-bottom:10px;">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–∫–∞–∑–∞</div>
                    <p style="font-size:13px; color:#777;">–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏ —Ü–µ–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—é—Ç.</p>
                    <div style="background:#222; border-radius:10px; height:250px; display:flex; align-items:center; justify-content:center; color:white; margin-bottom:20px;">
                        [–°–ö–†–ò–ù–®–û–¢ –ó–ê–ö–ê–ó–ê]
                    </div>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                        <button class="btn btn-danger" onclick="crmAction('–û—Ç–∫–ª–æ–Ω–µ–Ω–æ')">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                        <button class="btn btn-success" onclick="crmAction('–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç')">–ü—Ä–∏–Ω—è—Ç—å</button>
                    </div>
                </div>
            `;
        } else if (item.type === 'review') {
             html += `
                <div class="card">
                    <div style="font-weight:600; margin-bottom:10px;">–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞</div>
                    <div style="background:#f8f9fa; padding:12px; border-radius:10px; font-style:italic; font-size:13px; margin-bottom:15px;">
                        "${item.text}"
                    </div>
                    <div style="display:flex; gap:8px; margin-bottom:20px;">
                         <div style="width:60px; height:60px; background:#ddd; border-radius:8px;"></div>
                         <div style="width:60px; height:60px; background:#ddd; border-radius:8px;"></div>
                    </div>
                    <button class="btn btn-success" onclick="crmAction('–¢–µ–∫—Å—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω')">–†–∞–∑—Ä–µ—à–∏—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é</button>
                </div>
            `;
        } else if (item.type === 'payout') {
             html += `
                <div class="card">
                    <div style="font-weight:600; margin-bottom:10px;">–§–∏–Ω–∞–ª—å–Ω–∞—è –≤—ã–ø–ª–∞—Ç–∞</div>
                    <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                        <span style="color:#777;">–°—É–º–º–∞:</span>
                        <span style="font-weight:700;">${item.amount} ‚ÇΩ</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                        <span style="color:#777;">–ë–∞–Ω–∫:</span>
                        <span>${item.bank}</span>
                    </div>
                    
                    <button class="btn btn-primary" onclick="crmAction('–°—Ä–µ–¥—Å—Ç–≤–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã (–°–ë–ü)')">‚ö° –ê–≤—Ç–æ-–≤—ã–ø–ª–∞—Ç–∞</button>
                    <button class="btn btn-outline" style="margin-top:10px;" onclick="crmAction('–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤—ã–¥–∞–Ω')">üéÅ –í—ã–¥–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º</button>
                </div>
            `;
        }

        container.innerHTML = html;
        goTo('screen-crm-detail');
    }

    function crmAction(msg) {
        showLoader(true);
        setTimeout(() => { showLoader(false); showToast("‚úÖ " + msg); goBack(); }, 1000);
    }

    // --- UTILS ---
    function showLoader(state) {
        const el = document.getElementById('loader');
        if (state) el.classList.add('show'); else el.classList.remove('show');
    }
    function showToast(msg) {
        const t = document.getElementById('toast');
        document.getElementById('toast-msg').innerText = msg;
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 3000);
    }

</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–î–µ–ª–æ –≤ –®–ª—è–ø–µ | App</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7;
            --primary-dark: #5649c0;
            --bg: #f0f2f5;
            --surface: #ffffff;
            --text-main: #2d3436;
            --text-sec: #636e72;
            --success: #00b894;
            --warning: #fdcb6e;
            --danger: #ff7675;
            --radius: 20px;
            --shadow: 0 10px 30px rgba(0,0,0,0.06);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #dfe6e9;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }

        .app {
            width: 100%;
            max-width: 420px;
            height: 100%;
            background: var(--bg);
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.15);
        }

        @media (min-width: 425px) { .app { height: 95vh; border-radius: 30px; margin-top: 2.5vh; } }

        /* --- Header --- */
        .header {
            padding: 15px 20px;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 100;
            height: 60px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .header h1 { font-size: 17px; margin: 0; font-weight: 700; color: var(--text-main); }
        .back-btn {
            border: none; background: #f1f2f6; width: 32px; height: 32px;
            border-radius: 50%; color: var(--text-main); cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: 0.2s;
        }
        .back-btn.visible { opacity: 1; pointer-events: auto; }

        /* --- Content --- */
        .content { flex: 1; overflow-y: auto; padding: 20px; position: relative; padding-bottom: 40px; }

        .screen { display: none; animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        .screen.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Components --- */
        .btn {
            width: 100%; padding: 16px; border-radius: 14px; border: none;
            font-weight: 600; font-size: 15px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            transition: 0.1s; position: relative; overflow: hidden;
        }
        .btn:active { transform: scale(0.98); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        
        .btn-primary { background: var(--primary); color: white; box-shadow: 0 4px 15px rgba(108, 92, 231, 0.3); }
        .btn-success { background: var(--success); color: white; }
        .btn-outline { background: transparent; border: 1px solid #dcdde1; color: var(--text-sec); }

        .card {
            background: var(--surface); border-radius: var(--radius); padding: 20px;
            margin-bottom: 15px; box-shadow: var(--shadow);
        }

        /* --- Role Select --- */
        .role-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .role-card {
            background: white; padding: 30px 15px; border-radius: 20px; text-align: center;
            cursor: pointer; transition: 0.2s; border: 2px solid transparent; box-shadow: var(--shadow);
        }
        .role-card:active { transform: scale(0.95); }
        .role-emoji { font-size: 36px; display: block; margin-bottom: 10px; }

        /* --- Buyer Catalog --- */
        .product-card {
            background: white; border-radius: 20px; overflow: hidden; margin-bottom: 20px;
            box-shadow: var(--shadow); position: relative; cursor: pointer;
        }
        .prod-img { width: 100%; height: 180px; object-fit: cover; background: #eee; }
        .prod-info { padding: 15px; }
        .cashback-badge {
            position: absolute; top: 15px; right: 15px; background: var(--success); color: white;
            padding: 5px 10px; border-radius: 8px; font-weight: 700; font-size: 12px;
            box-shadow: 0 4px 10px rgba(0, 184, 148, 0.3);
        }

        /* --- Buyer Task Stepper --- */
        .stepper { display: flex; justify-content: space-between; margin-bottom: 25px; position: relative; }
        .stepper::before {
            content: ''; position: absolute; top: 10px; left: 0; right: 0; height: 3px;
            background: #e0e0e0; z-index: 0;
        }
        .step {
            width: 24px; height: 24px; border-radius: 50%; background: #e0e0e0;
            position: relative; z-index: 1; border: 3px solid var(--bg);
            transition: 0.3s;
        }
        .step.active { background: var(--primary); transform: scale(1.2); }
        .step.done { background: var(--success); }

        /* --- Upload Zone --- */
        .upload-zone {
            border: 2px dashed #b2bec3; border-radius: 16px; padding: 30px;
            text-align: center; color: #999; cursor: pointer; transition: 0.2s;
            background: #fdfdfd; margin: 15px 0;
        }
        .upload-zone.active { border-color: var(--primary); background: #eceaff; color: var(--primary); }
        .upload-zone.done { border-color: var(--success); background: #e6fffa; color: var(--success); }

        /* --- Seller CRM --- */
        .tabs { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px; margin-bottom: 15px; scrollbar-width: none; }
        .tabs::-webkit-scrollbar { display: none; }
        .tab {
            padding: 8px 16px; background: white; border-radius: 20px; font-size: 13px;
            font-weight: 600; color: var(--text-sec); white-space: nowrap; cursor: pointer;
        }
        .tab.active { background: var(--primary); color: white; }

        .crm-item {
            background: white; padding: 15px; border-radius: 16px; margin-bottom: 10px;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03); cursor: pointer;
        }

        /* --- Loader & Toast --- */
        .loader-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255,255,255,0.9); z-index: 200;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: 0.3s;
        }
        .loader-overlay.show { opacity: 1; pointer-events: auto; }
        .spinner {
            width: 40px; height: 40px; border: 4px solid #eee; border-top-color: var(--primary);
            border-radius: 50%; animation: spin 0.8s linear infinite; margin-bottom: 15px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        .toast {
            position: absolute; bottom: 30px; left: 20px; right: 20px;
            background: #2d3436; color: white; padding: 16px; border-radius: 12px;
            display: flex; align-items: center; gap: 10px; font-size: 14px; font-weight: 500;
            transform: translateY(100px); transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 300;
        }
        .toast.show { transform: translateY(0); }

        /* --- Status States --- */
        .status-box {
            padding: 15px; border-radius: 12px; font-size: 13px; margin-bottom: 20px;
            display: flex; align-items: center; gap: 10px;
        }
        .st-wait { background: #fff3cd; color: #856404; }
        .st-ok { background: #d4edda; color: #155724; }

    </style>
</head>
<body>

<div class="app">
    <div class="header">
        <button class="back-btn" id="backBtn" onclick="goBack()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
        </button>
        <h1 id="page-title">–î–µ–ª–æ –≤ –®–ª—è–ø–µ</h1>
        <div style="width: 32px;"></div>
    </div>

    <div class="content">

        <div id="screen-home" class="screen active">
            <div style="text-align: center; margin-top: 40px; margin-bottom: 40px;">
                <div style="font-size: 50px; margin-bottom: 10px;">üé©</div>
                <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</h2>
                <p style="color: var(--text-sec); font-size: 14px;">–ï–¥–∏–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Ä–∞–∑–¥–∞—á</p>
            </div>

            <div class="role-grid">
                <div class="role-card" onclick="setRole('buyer')">
                    <span class="role-emoji">üõç</span>
                    <b>–Ø –ü–æ–∫—É–ø–∞—Ç–µ–ª—å</b>
                    <div style="font-size: 11px; color: #aaa; margin-top: 5px;">–•–æ—á—É 100% –ö—ç—à–±—ç–∫</div>
                </div>
                <div class="role-card" onclick="setRole('seller')">
                    <span class="role-emoji">üíº</span>
                    <b>–Ø –°–µ–ª–ª–µ—Ä</b>
                    <div style="font-size: 11px; color: #aaa; margin-top: 5px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</div>
                </div>
            </div>
            
            <div style="margin-top: 30px; background: white; padding: 15px; border-radius: 16px; box-shadow: var(--shadow);">
                <div style="font-weight: 600; font-size: 13px; margin-bottom: 5px;">üì¢ –ù–æ–≤–æ—Å—Ç–∏</div>
                <div style="font-size: 12px; color: var(--text-sec);">–ó–∞–ø—É—â–µ–Ω –∞–≤—Ç–æ-–≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –°–ë–ü. –¢–µ–ø–µ—Ä—å –¥–µ–Ω—å–≥–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –∑–∞ 1 –º–∏–Ω—É—Ç—É!</div>
            </div>
        </div>

        <div id="screen-catalog" class="screen">
            <h2 style="margin-bottom: 20px;">–ö–∞—Ç–∞–ª–æ–≥</h2>
            
            <div class="product-card" onclick="startTask('Roman Magic')">
                <div class="cashback-badge">100% –ö—ç—à–±—ç–∫</div>
                <img src="https://ir.ozone.ru/s3/multimedia-0/wc1000/6647987820.jpg" class="prod-img">
                <div class="prod-info">
                    <div style="font-weight: 700; font-size: 16px; margin-bottom: 5px;">–ù–∞–±–æ—Ä –æ–ø—ã—Ç–æ–≤ Roman Magic</div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #b2bec3; text-decoration: line-through; font-size: 13px;">1200 ‚ÇΩ</span>
                        <span style="color: var(--success); font-weight: 700;">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    </div>
                </div>
            </div>

            <div class="product-card" onclick="startTask('Chemistry Kids')">
                <div class="cashback-badge">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</div>
                <img src="https://ir.ozone.ru/s3/multimedia-v/wc1000/6682736467.jpg" class="prod-img">
                <div class="prod-info">
                    <div style="font-weight: 700; font-size: 16px; margin-bottom: 5px;">–Æ–Ω—ã–π –•–∏–º–∏–∫</div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #b2bec3; text-decoration: line-through; font-size: 13px;">950 ‚ÇΩ</span>
                        <span style="color: var(--success); font-weight: 700;">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="screen-task" class="screen">
            <div class="stepper">
                <div class="step active" id="s1"></div> <div class="step" id="s2"></div> <div class="step" id="s3"></div> <div class="step" id="s4"></div> <div class="step" id="s5"></div> </div>

            <div id="task-container">
                </div>
        </div>


        <div id="screen-crm" class="screen">
            <div style="background: var(--primary); padding: 25px; border-radius: 20px; color: white; margin-bottom: 20px; box-shadow: 0 10px 20px -5px rgba(108,92,231,0.4);">
                <div style="font-size: 13px; opacity: 0.8;">–ë–∞–ª–∞–Ω—Å</div>
                <div style="font-size: 28px; font-weight: 700; margin: 5px 0;">12 500 ‚ÇΩ</div>
                <div style="font-size: 12px; display: flex; gap: 15px;">
                    <span>–í —Ä–∞–±–æ—Ç–µ: <b>8</b></span>
                    <span>–ó–∞–≤–µ—Ä—à–µ–Ω–æ: <b>142</b></span>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" onclick="filterCrm('all', this)">–í—Å–µ</div>
                <div class="tab" onclick="filterCrm('order', this)">–ó–∞–∫–∞–∑—ã (2)</div>
                <div class="tab" onclick="filterCrm('review', this)">–û—Ç–∑—ã–≤—ã (4)</div>
                <div class="tab" onclick="filterCrm('payout', this)">–í—ã–ø–ª–∞—Ç—ã (1)</div>
            </div>

            <div id="crm-list"></div>
        </div>

        <div id="screen-crm-detail" class="screen">
            <div id="crm-detail-content"></div>
        </div>

    </div>

    <div id="loader" class="loader-overlay">
        <div class="spinner"></div>
        <div style="font-weight: 600; color: var(--text-sec);">–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
    </div>

    <div id="toast" class="toast">
        <span id="toast-icon">‚úÖ</span>
        <span id="toast-msg">–°–æ–æ–±—â–µ–Ω–∏–µ</span>
    </div>

</div>

<script>
    // --- STATE MANAGEMENT ---
    let historyStack = ['screen-home'];
    let currentRole = '';
    let currentTaskStep = 1;
    let currentTaskName = '';
    
    // --- MOCK DATA ---
    const crmData = [
        { id: 1, type: 'order', user: '–û–ª—å–≥–∞ –ö.', prod: 'Roman Magic', time: '5 –º–∏–Ω', status: '–°–∫—Ä–∏–Ω –∑–∞–∫–∞–∑–∞', img: 'https://via.placeholder.com/150' },
        { id: 2, type: 'review', user: '–ú–∞–∫—Å–∏–º –ì.', prod: 'Roman Magic', time: '1 —á', status: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∑—ã–≤–∞', text: '–ö–ª–∞—Å—Å–Ω—ã–π –Ω–∞–±–æ—Ä!' },
        { id: 3, type: 'payout', user: '–ê–ª–∏–Ω–∞ –§.', prod: '–Æ–Ω—ã–π –•–∏–º–∏–∫', time: '2 —á', status: '–ñ–¥–µ—Ç –≤—ã–ø–ª–∞—Ç—É', amount: 950 },
    ];

    // --- NAVIGATION ---
    function goTo(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(screenId).classList.add('active');
        
        // Header Logic
        const backBtn = document.getElementById('backBtn');
        const title = document.getElementById('page-title');
        
        if (screenId === 'screen-home') {
            backBtn.classList.remove('visible');
            title.innerText = "–î–µ–ª–æ –≤ –®–ª—è–ø–µ";
            historyStack = ['screen-home'];
        } else {
            backBtn.classList.add('visible');
            historyStack.push(screenId);
        }

        if (screenId.includes('buyer')) title.innerText = "–ü–æ–∫—É–ø–∫–∞";
        if (screenId.includes('crm')) title.innerText = "–ö–∞–±–∏–Ω–µ—Ç –°–µ–ª–ª–µ—Ä–∞";
    }

    function goBack() {
        if (historyStack.length > 1) {
            historyStack.pop();
            const prev = historyStack[historyStack.length - 1];
            
            // Fix double jump
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(prev).classList.add('active');
            
            if (prev === 'screen-home') {
                document.getElementById('backBtn').classList.remove('visible');
                document.getElementById('page-title').innerText = "–î–µ–ª–æ –≤ –®–ª—è–ø–µ";
            }
        }
    }

    function setRole(role) {
        currentRole = role;
        if (role === 'buyer') goTo('screen-catalog');
        else {
            renderCrmList();
            goTo('screen-crm');
        }
    }

    // --- BUYER LOGIC (THE BOT FLOW) ---
    
    function startTask(productName) {
        currentTaskName = productName;
        currentTaskStep = 1;
        renderBuyerStep();
        goTo('screen-task');
    }

    function renderBuyerStep() {
        const container = document.getElementById('task-container');
        const steps = [1,2,3,4,5];
        
        // Update Stepper
        steps.forEach(s => {
            const el = document.getElementById('s'+s);
            el.className = 'step';
            if (s < currentTaskStep) el.classList.add('done');
            if (s === currentTaskStep) el.classList.add('active');
        });

        let html = '';

        if (currentTaskStep === 1) { // SEARCH
            html = `
                <h2>üîé –®–∞–≥ 1: –ü–æ–∏—Å–∫</h2>
                <div class="card">
                    <p>1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Wildberries.</p>
                    <p>2. –í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å:</p>
                    <div style="background:#f1f2f6; padding:12px; border-radius:10px; font-weight:700; text-align:center; color:var(--primary); margin:10px 0;">–Ω–∞–±–æ—Ä –æ–ø—ã—Ç–æ–≤ –¥–ª—è –¥–µ—Ç–µ–π</div>
                    <p>3. –ù–∞–π–¥–∏—Ç–µ –±—Ä–µ–Ω–¥ <b>–î–µ–ª–æ –≤ –®–ª—è–ø–µ</b> –∏ —Ç–æ–≤–∞—Ä "${currentTaskName}".</p>
                    <p>4. –û—Ñ–æ—Ä–º–∏—Ç–µ –∑–∞–∫–∞–∑ (–Ω–µ –æ–ø–ª–∞—á–∏–≤–∞–π—Ç–µ, –µ—Å–ª–∏ —ç—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, –∏–ª–∏ –æ–ø–ª–∞—Ç–∏—Ç–µ –¥–ª—è –∫—ç—à–±—ç–∫–∞).</p>
                </div>
                <button class="btn btn-primary" onclick="nextStep()">üì∏ –Ø –æ—Ñ–æ—Ä–º–∏–ª –∑–∞–∫–∞–∑</button>
            `;
        } 
        else if (currentTaskStep === 2) { // ORDER PROOF
            html = `
                <h2>üì∏ –®–∞–≥ 2: –°–∫—Ä–∏–Ω –∑–∞–∫–∞–∑–∞</h2>
                <p>–°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–î–æ—Å—Ç–∞–≤–∫–∏", –≥–¥–µ –≤–∏–¥–µ–Ω —Å—Ç–∞—Ç—É—Å "–û—Ñ–æ—Ä–º–ª–µ–Ω".</p>
                <div class="upload-zone" onclick="simulateUpload(this)">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç</div>
                <button id="btn-next" class="btn btn-primary" disabled onclick="simulateCheck()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É</button>
            `;
        }
        else if (currentTaskStep === 3) { // PICKUP PROOF
            html = `
                <div class="status-box st-ok">‚úÖ –ó–∞–∫–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω! –ñ–¥–µ–º –¥–æ—Å—Ç–∞–≤–∫—É.</div>
                <h2>üì¶ –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ</h2>
                <p>–ö–æ–≥–¥–∞ –∑–∞–±–µ—Ä–µ—Ç–µ —Ç–æ–≤–∞—Ä –∏–∑ –ü–í–ó, —Å–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ç–æ –∫–æ—Ä–æ–±–∫–∏ –≤ —Ä—É–∫–∞—Ö.</p>
                <div class="upload-zone" onclick="simulateUpload(this)">üì∏ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ —Å –ü–í–ó</div>
                <button id="btn-next" class="btn btn-primary" disabled onclick="simulateCheck()">–Ø –∑–∞–±—Ä–∞–ª —Ç–æ–≤–∞—Ä</button>
            `;
        }
        else if (currentTaskStep === 4) { // DRAFT REVIEW
            html = `
                 <div class="status-box st-ok">‚úÖ –§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞ –ø—Ä–∏–Ω—è—Ç–æ.</div>
                 <h2>üìù –®–∞–≥ 4: –û—Ç–∑—ã–≤</h2>
                 <p>–ü—Ä–∏—à–ª–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ —Ñ–æ—Ç–æ –¥–ª—è –æ—Ç–∑—ã–≤–∞. –ú—ã –ø—Ä–æ–≤–µ—Ä–∏–º –µ–≥–æ –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π.</p>
                 <input type="text" placeholder="–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞..." style="width:100%; padding:15px; border-radius:12px; border:1px solid #ddd; margin-bottom:10px;">
                 <div class="upload-zone" onclick="simulateUpload(this)">üìÇ –§–æ—Ç–æ/–í–∏–¥–µ–æ –¥–ª—è –æ—Ç–∑—ã–≤–∞</div>
                 <button id="btn-next" class="btn btn-primary" disabled onclick="simulateCheck()">–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç</button>
            `;
        }
        else if (currentTaskStep === 5) { // FINAL & PAYOUT
            html = `
                <div class="status-box st-ok">‚úÖ –¢–µ–∫—Å—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω! –ü—É–±–ª–∏–∫—É–π—Ç–µ.</div>
                <h2>üí∞ –§–∏–Ω–∞–ª: –í—ã–ø–ª–∞—Ç–∞</h2>
                <p>–í—ã–ª–æ–∂–∏—Ç–µ –æ—Ç–∑—ã–≤ –Ω–∞ WB, —Å–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç "–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ" –∏ –≤–≤–µ–¥–∏—Ç–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã.</p>
                <div class="upload-zone" onclick="simulateUpload(this)">‚≠ê –°–∫—Ä–∏–Ω –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–∑—ã–≤–∞</div>
                <input type="text" placeholder="+7 (900) ... (–°–ë–ü)" style="width:100%; padding:15px; border-radius:12px; border:1px solid #ddd; margin-bottom:15px;">
                <button id="btn-next" class="btn btn-success" disabled onclick="finishTask()">–ü–æ–ª—É—á–∏—Ç—å –¥–µ–Ω—å–≥–∏</button>
            `;
        }

        container.innerHTML = html;
    }

    // Simulation Utils
    function nextStep() {
        currentTaskStep++;
        renderBuyerStep();
    }

    function simulateUpload(el) {
        el.innerText = "‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...";
        el.classList.add('active');
        setTimeout(() => {
            el.innerHTML = "‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω";
            el.classList.remove('active');
            el.classList.add('done');
            document.getElementById('btn-next').disabled = false;
        }, 800);
    }

    function simulateCheck() {
        showLoader(true);
        setTimeout(() => {
            showLoader(false);
            showToast("‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä –æ–¥–æ–±—Ä–∏–ª –≤–∞—à –æ—Ç—á–µ—Ç!");
            nextStep();
        }, 2000); // 2 seconds delay to simulate manager
    }

    function finishTask() {
        showLoader(true);
        setTimeout(() => {
            showLoader(false);
            alert("üéâ –í—ã–ø–ª–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ.");
            goTo('screen-home');
        }, 2000);
    }


    // --- SELLER LOGIC ---

    function renderCrmList(filterType = 'all') {
        const container = document.getElementById('crm-list');
        container.innerHTML = '';
        
        crmData.forEach(item => {
            if (filterType !== 'all' && item.type !== filterType) return;
            
            let icon = 'üì¶';
            if (item.type === 'review') icon = 'üìù';
            if (item.type === 'payout') icon = 'üí∞';

            container.innerHTML += `
                <div class="crm-item" onclick="openCrmDetail(${item.id})">
                    <div style="display:flex; align-items:center; gap:12px;">
                        <div style="font-size:24px; background:#f1f2f6; width:40px; height:40px; border-radius:10px; display:flex; align-items:center; justify-content:center;">${icon}</div>
                        <div>
                            <div style="font-weight:600; font-size:14px;">${item.user}</div>
                            <div style="font-size:12px; color:#999;">${item.prod} ‚Ä¢ ${item.status}</div>
                        </div>
                    </div>
                    <div style="font-size:12px; color:var(--primary); font-weight:600;">${item.time}</div>
                </div>
            `;
        });
    }

    function filterCrm(type, tabEl) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        tabEl.classList.add('active');
        renderCrmList(type);
    }

    function openCrmDetail(id) {
        const item = crmData.find(i => i.id === id);
        const container = document.getElementById('crm-detail-content');
        
        let html = `
            <h2>${item.status}</h2>
            <div class="card">
                <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                    <b>${item.user}</b>
                    <span style="color:#999;">${item.time} –Ω–∞–∑–∞–¥</span>
                </div>
        `;

        if (item.type === 'order') {
            html += `
                <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –∑–∞–∫–∞–∑–∞.</p>
                <div style="background:#333; height:200px; border-radius:10px; display:flex; align-items:center; justify-content:center; color:white; margin-bottom:20px;">[–°–ö–†–ò–ù–®–û–¢]</div>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                    <button class="btn btn-outline" onclick="goBack()">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                    <button class="btn btn-success" onclick="crmAction('–ó–∞–∫–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω')">–ü—Ä–∏–Ω—è—Ç—å</button>
                </div>
            `;
        } else if (item.type === 'review') {
             html += `
                <p>–¢–µ–∫—Å—Ç: "<i>${item.text}</i>"</p>
                <div style="display:flex; gap:5px; margin-bottom:20px;">
                    <div style="width:60px; height:60px; background:#eee; border-radius:8px;"></div>
                    <div style="width:60px; height:60px; background:#eee; border-radius:8px;"></div>
                </div>
                <button class="btn btn-success" onclick="crmAction('–û—Ç–∑—ã–≤ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω')">–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å</button>
            `;
        } else if (item.type === 'payout') {
             html += `
                <p>–ö –≤—ã–ø–ª–∞—Ç–µ: <b style="font-size:18px;">${item.amount} ‚ÇΩ</b></p>
                <div style="background:#f1f2f6; padding:10px; border-radius:10px; margin-bottom:20px;">–¢-–ë–∞–Ω–∫: +7 999 ...</div>
                <button class="btn btn-primary" onclick="crmAction('–í—ã–ø–ª–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞')">‚ö° –ê–≤—Ç–æ-–≤—ã–ø–ª–∞—Ç–∞</button>
            `;
        }

        html += `</div>`;
        container.innerHTML = html;
        goTo('screen-crm-detail');
    }

    function crmAction(msg) {
        showLoader(true);
        setTimeout(() => {
            showLoader(false);
            showToast("‚úÖ " + msg);
            goBack();
        }, 1000);
    }

    // --- UTILS ---
    function showLoader(state) {
        const el = document.getElementById('loader');
        if (state) el.classList.add('show');
        else el.classList.remove('show');
    }

    function showToast(msg) {
        const t = document.getElementById('toast');
        document.getElementById('toast-msg').innerText = msg;
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), 3000);
    }

</script>

</body>
</html>
